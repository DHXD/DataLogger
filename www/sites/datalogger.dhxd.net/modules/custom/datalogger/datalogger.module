<?php

function datalogger_menu() {
  $items['create/stations'] = array(
      'title' => 'Datalogger',
      'page callback' => '_datalogger_nodes',
      'access callback' => TRUE
  );
  
  $items['create/form/station'] = array(
      'title' => 'Form Datalogger',
      'page callback' => 'drupal_get_form',
      'page arguments' => array(
          '_datalogger_form'
      ),
      'access callback' => TRUE
  );
  
  $items['command'] = array(
      'title' => 'Station',
      'page callback' => 'drupal_get_form',
      'page arguments' => array(
          '_command_form'
      ),
      'access callback' => TRUE
  );
  
  return $items;
}

function _datalogger_init_node($title, $field_station_code, 
    $field_station_sim_number, $field_station_address, $field_station_longitude, 
    $field_station_latitude, $field_station_password, 
    $field_station_transmission_speed, $field_station_power, 
    $field_station_diagnostic_error) {
  $node = new stdClass();
  $node->title = $title;
  $node->type = 'station';
  $node->created = time();
  $node->changed = $node->created;
  $node->status = 1; // Published?
  $node->promote = 0; // Display on front page?
  $node->sticky = 0; // Display top of page?
  $node->format = 1; // Filtered HTML?
  $node->uid = 1; // Content owner uid (author)?
  $node->language = 'und';
  
  node_object_prepare($node);
  $node->field_station_code[$node->language][0]['value'] = $field_station_code;
  $node->field_station_address[$node->language][0]['value'] = $field_station_address;
  $node->field_station_diagnostic_error[$node->language][0]['value'] = $field_station_diagnostic_error;
  $node->field_station_latitude[$node->language][0]['value'] = $field_station_latitude;
  $node->field_station_longitude[$node->language][0]['value'] = $field_station_longitude;
  $node->field_station_password[$node->language][0]['value'] = $field_station_password;
  $node->field_station_power[$node->language][0]['value'] = $field_station_power;
  $node->field_station_sim_number[$node->language][0]['value'] = $field_station_sim_number;
  $node->field_station_transmission_speed[$node->language][0]['value'] = $field_station_transmission_speed;
  
  $node = node_submit($node);
  node_save($node);
}

function _datalogger_nodes() {
  // for ($i = 1; $i < 227; $i ++) {
    // _datalogger_init_node("Station - " . $i, "Code - " . $i, "Address - " . $i, 1, $i, $i, 
        // "Password" . $i, $i, "0168123456" . (78 + $i), $i);
  // }
  
  return "Finished create Stations.";
}

function _datalogger_form($form, &$form_submit) {
  $form['station_name'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Name'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['station_sim_number'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Sim Number'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['station_address'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Address'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['station_password'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Password'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['station_longitude'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Longitude'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['Station_latitude'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Latitude'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['station_transmission_speed'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Transmission Speed'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['Station_power'] = array(
      '#type' => 'textfield',
      '#title' => t('Station Power'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['submit'] = array(
      '#type' => 'submit',
      '#value' => t('Save'),
      '#submit' => array(
          'deductible_submit'
      )
  );

  $form['delete'] = array(
      '#type' => 'button',
      '#value' => t('Delete')
  );
  $form['edit'] = array(
      '#type' => 'button',
      '#value' => t('Edit')
  );

  return $form;

}

function _command_form($form, &$form_submit) {

  $options_first = array(
      'get_host_phone_no' => 'GET HOST PHONE NO',
      'set_host_phone_no' => 'SET HOST PHONE NO',
      'get_r_clear_time_hhnn' => 'GET R:CLEAR TIME:HHNN',
      'set_r_clear_time_hhnn' => 'SET R:CLEAR TIME:HHNN',
  );

  $form['command_first'] = array(
      '#type' => 'select',
      '#title' => 'Command',
      '#options' => $options_first,

  );

  $form['host_phone_number'] = array(
      '#type' => 'textfield',
      '#title' => t('Host Phone Number'),
      '#cols' => 30,
      '#rows' => 1
  );

  $form['submit'] = array(
      '#type' => 'submit',
      '#value' => t('Send Now!'),
      '#submit' => array(
          'deductible_submit'
      )
  );

  return $form;

}

// function _command_options() {
//   return array(
//       'get_host_phone_no' => 'GET HOST PHONE NO',
//       'set_host_phone_no' => 'SET HOST PHONE NO',
//       'get_r_clear_time_hhnn' => 'GET R:CLEAR TIME:HHNN',
//       'set_r_clear_time_hhnn' => 'SET R:CLEAR TIME:HHNN',
//   );
// }
